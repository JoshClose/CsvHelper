<!DOCTYPE html><html lang="en-US"><head><link rel="preload" as="script" href="https://joshclose.github.io/CsvHelper/bootstrap.18f2d515.js"/><link rel="preload" as="script" href="https://joshclose.github.io/CsvHelper/templates/src/components/content.a5c1a482.js"/><link rel="preload" as="script" href="https://joshclose.github.io/CsvHelper/main.3bbedefe.js"/><link rel="preload" as="style" href="https://joshclose.github.io/CsvHelper/main.css"/><link rel="stylesheet" href="https://joshclose.github.io/CsvHelper/main.css"/><link rel="preload" as="style" href="https://joshclose.github.io/CsvHelper/styles.7ec999e0.css"/><link rel="stylesheet" href="https://joshclose.github.io/CsvHelper/styles.7ec999e0.css"/><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no"/></head><body><div id="root"><div class="layout" data-reactroot=""><a class="fork-me-on-github" href="https://github.com/joshclose/csvhelper" target="_blank"><img src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a><header class="header"><nav class="navbar is-light"><div class="container"><div class="navbar-brand"><a class="navbar-item active" aria-current="page" href="https://joshclose.github.io/CsvHelper/"><img src="https://joshclose.github.io/CsvHelper/images/logo-header.png" width="66" height="28"/></a><div class="navbar-burger burger"><span></span><span></span><span></span></div></div><div class="navbar-menu"><div class="navbar-start"><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="https://joshclose.github.io/CsvHelper/reading">Reading</a><div class="navbar-dropdown"><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/reading#getting-all-records">Getting All Records</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/reading#reading-records">Reading Records</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/reading#getting-a-single-record">Getting a Single Record</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/reading#getting-fields">Getting Fields</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/reading#malformed-field-fallback">Malformed Field Fallback</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/reading#reading-context">Reading Context</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/reading#configuration">Configuration</a></div></div><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link active" aria-current="page" href="https://joshclose.github.io/CsvHelper/writing">Writing</a><div class="navbar-dropdown"><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/writing#writing-all-records">Writing All Records</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/writing#writing-a-single-record">Writing a Single Record</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/writing#writing-fields">Writing Fields</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/writing#ending-the-row">Ending the Row</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/writing#writing-context">Writing Context</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/writing#configuration">Configuration</a></div></div><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="https://joshclose.github.io/CsvHelper/mapping">Mapping</a><div class="navbar-dropdown"><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/mapping#reference-mapping">Reference Mapping</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/mapping#auto-mapping">Auto Mapping</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/mapping#options">Options</a></div></div><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="https://joshclose.github.io/CsvHelper/configuration">Configuration</a><div class="navbar-dropdown"><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/configuration#malicious-injection-protection">Malicious Injection Protection</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/configuration#headers">Headers</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/configuration#mapping">Mapping</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/configuration#constructor-mapping">Constructor Mapping</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/configuration#error-handling">Error Handling</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/configuration#type-conversion">Type Conversion</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/configuration#reading">Reading</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/configuration#parsing">Parsing</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/configuration#writing">Writing</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/configuration#formatting">Formatting</a></div></div><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="https://joshclose.github.io/CsvHelper/type-conversion">Type Conversion</a><div class="navbar-dropdown"></div></div><div class="navbar-item has-dropdown is-hoverable"><div class="navbar-link">Misc</div><div class="navbar-dropdown"><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/examples">Examples</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/change-log">Change Log</a></div></div></div></div></div></nav><div class="navbar"></div></header><div class="container"><div class="writing"><h1 id="writing" class="title is-1"><span>Writing</span></h1><div class="columns"><div class="column"><p>This library was created to work as easy as possible without any configuration by default. If your class property names match your CSV file header names, it&#39;s as simple as this.</p></div></div><div class="columns"><div class="column"><pre><code class="box cs"><span class="hljs-keyword">var</span> records = <span class="hljs-keyword">new</span> List&lt;MyClass&gt; { ... };
<span class="hljs-keyword">var</span> csv = <span class="hljs-keyword">new</span> CsvWriter( textWriter );
csv.WriteRecords( records );</code></pre></div></div><h2 id="injection-warning" class="title is-2 has-text-danger">
    <span>Injection Warning</span>
</h2>

<hr/>

<div class="columns"><div class="column"><p>When opening a CSV in an external program, a formula in a field could be ran that contains a vulnerability. Read more here: <a href="https://www.contextis.com/blog/comma-separated-vulnerabilities" target="_blank">Comma Separated Vulnerabilities</a>. Due to this issue, if a field starts with characters <code>=</code>, <code>@</code>, <code>+</code>, or <code>-</code>, that field will be prepended with a <code>\t</code>. If the field is quoted, the <code>\t</code> will come after the <code>&quot;</code>.</p></div></div><div class="columns"><div class="column"><pre><code class="box undefined">=one   -&gt; \t=one
<span class="hljs-string">"=one"</span> -&gt; <span class="hljs-string">"\t=one"</span></code></pre></div></div><div class="columns"><div class="column"><p>You are able to turn off this functionality in configuration.</p></div></div><div class="columns"><div class="column"><pre><code class="box cs">csv.Configuration.SanitizeForInjection = <span class="hljs-literal">false</span>;</code></pre></div></div><h2 id="writing-all-records" class="title is-2"><span>Writing All Records</span></h2><hr/>

<div class="columns"><div class="column"><p>The most common scenario is using the <code>WriteRecords</code> method. You can pass it an <code>IEnumerable</code> of records and it will write those objects.</p></div></div><h3 id="writerecords" class="title is-3"><span>WriteRecords</span></h3><div class="columns"><div class="column"><p>Writes all records.</p></div></div><div class="columns"><div class="column"><pre><code class="box cs"><span class="hljs-keyword">var</span> records = <span class="hljs-keyword">new</span> List&lt;MyClass&gt;
{
    <span class="hljs-keyword">new</span> MyClass { Id = <span class="hljs-number">1</span>, Name = <span class="hljs-string">"one"</span> },
    <span class="hljs-keyword">new</span> MyClass { Id = <span class="hljs-number">2</span>, Name = <span class="hljs-string">"two"</span> },
};
csv.WriteRecords( records );

<span class="hljs-comment">// Dynamic</span>
<span class="hljs-keyword">var</span> records = <span class="hljs-keyword">new</span> List&lt;<span class="hljs-keyword">dynamic</span>&gt;();
<span class="hljs-keyword">dynamic</span> record = <span class="hljs-keyword">new</span> ExpandoObject();
record.Id = <span class="hljs-number">1</span>;
record.Name = <span class="hljs-string">"one"</span>;
records.Add( record );
csv.WriteRecords( records );

<span class="hljs-comment">// Anonymous</span>
<span class="hljs-keyword">var</span> records = <span class="hljs-keyword">new</span> List&lt;<span class="hljs-keyword">object</span>&gt;
{
    <span class="hljs-keyword">new</span> { Id = <span class="hljs-number">1</span>, Name = <span class="hljs-string">"one"</span> },
    <span class="hljs-keyword">new</span> { Id = <span class="hljs-number">2</span>, Name = <span class="hljs-string">"two"</span> },
};
csv.WriteRecords( records );</code></pre></div></div><h2 id="writing-a-single-record" class="title is-2"><span>Writing a Single Record</span></h2><hr/>

<div class="columns"><div class="column"><p>Sometimes you want to write individual records by themselves. When you are done writing the row, don&#39;t forget to call <code>NextRecord</code> to flush the data and write the line ending.</p></div></div><h3 id="writeheader" class="title is-3"><span>WriteHeader</span></h3><div class="columns"><div class="column"><p>Writes the header record. You can call this method on any row if you want to write multiple headers.</p></div></div><div class="columns"><div class="column"><pre><code class="box cs">csv.WriteHeader&lt;MyClass&gt;();
csv.WriteHeader( Type type );
csv.NextRecord();</code></pre></div></div><h3 id="writerecord" class="title is-3"><span>WriteRecord</span></h3><div class="columns"><div class="column"><p>Writes a record.</p></div></div><div class="columns"><div class="column"><pre><code class="box cs"><span class="hljs-keyword">var</span> record = <span class="hljs-keyword">new</span> MyClass { Id = <span class="hljs-number">1</span>, Name = <span class="hljs-string">"one"</span> };
csv.WriteRecord( record );
csv.NextRecord();

<span class="hljs-comment">// Dynamic</span>
<span class="hljs-keyword">dynamic</span> record = <span class="hljs-keyword">new</span> ExpandoObject();
record.Id = <span class="hljs-number">1</span>;
record.Name = <span class="hljs-string">"one"</span>;
csv.WriteRecord( record );
csv.NextRecord();

<span class="hljs-comment">// Anonymous</span>
<span class="hljs-keyword">var</span> record = <span class="hljs-keyword">new</span> { Id = <span class="hljs-number">1</span>, Name = <span class="hljs-string">"one"</span> };
csv.WriteRecord( record );
csv.NextRecord();</code></pre></div></div><h2 id="writing-fields" class="title is-2"><span>Writing Fields</span></h2><hr/>

<div class="columns"><div class="column"><p>You can even write a single field.</p></div></div><h3 id="writefield" class="title is-3"><span>WriteField</span></h3><div class="columns"><div class="column"><p>Write any type of object to a field. You can specify your own <code>ITypeConverter</code> to handle converting the type to a string if none of the built in converters work for you.</p></div></div><div class="columns"><div class="column"><pre><code class="box cs"><span class="hljs-comment">// Write a string</span>
csv.WriteField( <span class="hljs-string">"field"</span> );

<span class="hljs-comment">// Write a string passing in a value indicating</span>
<span class="hljs-comment">// if the field should be quoted. This will ignore</span>
<span class="hljs-comment">// any configuration and only quote based on the</span>
<span class="hljs-comment">// shouldQuote parameter passed in.</span>
csv.WriteField( <span class="hljs-string">"field"</span>, <span class="hljs-literal">true</span> );

<span class="hljs-comment">// Write any type</span>
csv.WriteField( <span class="hljs-number">1</span> );

<span class="hljs-comment">// Write any type and use the given type converter</span>
<span class="hljs-comment">// to convert the type to a string.</span>
csv.WriteField( <span class="hljs-keyword">value</span>, myTypeConverter );

<span class="hljs-comment">// Write any type and use the given type converter</span>
<span class="hljs-comment">// to convert the type to a string.</span>
csv.WriteField&lt;MyTypeConverter&gt;( <span class="hljs-keyword">value</span> );

<span class="hljs-comment">// Write a field that has already been converted</span>
<span class="hljs-comment">// by a type converter. If the field is null, it</span>
<span class="hljs-comment">// won't get written.</span>
csv.WriteConvertedField( <span class="hljs-string">"field"</span> );

<span class="hljs-comment">// Don't forget to forget to end the row.</span>
csv.NextRecord();</code></pre></div></div><h3 id="writecomment" class="title is-3"><span>WriteComment</span></h3><div class="columns"><div class="column"><p>This will write text to the field using the comment character supplied in <code>Configuration.Comment</code>.</p></div></div><div class="columns"><div class="column"><pre><code class="box cs">csv.WriteComment( <span class="hljs-string">"This is a comment. "</span>);
csv.NextRecord();</code></pre></div></div><h2 id="ending-the-row" class="title is-2"><span>Ending the Row</span></h2><hr/>

<div class="columns"><div class="column"><p>When you are done writing the row, you need to flush the fields and start a new row. Flushing and starting a new row are separated so that you can flush without creating a new row. Calling <code>NextRecord</code> will flush for you.</p></div></div><h3 id="flush" class="title is-3"><span>Flush</span></h3><div class="columns"><div class="column"><p>Serialize the fields to the <code>TextReader</code>.</p></div></div><div class="columns"><div class="column"><pre><code class="box cs">csv.Flush();</code></pre></div></div><h3 id="flushasync" class="title is-3"><span>FlushAsync</span></h3><div class="columns"><div class="column"><p>Serialize the fields to the <code>TextReader</code> asynchronously. If the <code>TextReader</code> supplied is tied to a network or some other slow to write functionality, flushing asynchronously is probably a good idea.</p></div></div><div class="columns"><div class="column"><pre><code class="box cs">csv.FlushAsync();</code></pre></div></div><h3 id="nextrecord" class="title is-3"><span>NextRecord</span></h3><div class="columns"><div class="column"><p>Ends the current record and starts a new record. This will call <code>Flush</code> then write a newline.</p></div></div><div class="columns"><div class="column"><pre><code class="box cs">csv.NextRecord();</code></pre></div></div><h3 id="nextrecordasync" class="title is-3"><span>NextRecordAsync</span></h3><div class="columns"><div class="column"><p>Ends the current record and start a new record asynchronously. This will call <code>FlushAsync</code> then asynchronously write a newline.</p></div></div><div class="columns"><div class="column"><pre><code class="box cs">csv.NextRecordAsync();</code></pre></div></div><h2 id="writing-context" class="title is-2"><span>Writing Context</span></h2><hr/>

<div class="columns"><div class="column"><p>When writing, all the information in the system is held in a context object. If you need to get raw system information for some reason, it&#39;s available here. When an exception is throw, the context is included so you can inspect the current state of the writer.</p></div></div><h2 id="configuration" class="title is-2"><span>Configuration</span></h2><hr/>

<div class="columns"><div class="column"><p>See <a href="https://joshclose.github.io/CsvHelper/configuration">configuration</a></p></div></div><br/>
</div></div></div></div><script type="text/javascript">window.__CSS_CHUNKS__ = {"main":"https://joshclose.github.io/CsvHelper/styles.7ec999e0.css"}</script><script type="text/javascript">
    window.__routeInfo = {"path":"writing","templateID":0,"sharedPropsHashes":{},"localProps":null,"allProps":{"className":"writing","data":"# Writing\r\n\r\nThis library was created to work as easy as possible without any configuration by default. If your class property names match your CSV file header names, it's as simple as this.\r\n\r\n```cs\r\nvar records = new List<MyClass> { ... };\r\nvar csv = new CsvWriter( textWriter );\r\ncsv.WriteRecords( records );\r\n```\r\n\r\n<h2 id=\"injection-warning\" class=\"title is-2 has-text-danger\">\r\n\t<span>Injection Warning</span>\r\n</h2>\r\n\r\n<hr/>\r\n\r\nWhen opening a CSV in an external program, a formula in a field could be ran that contains a vulnerability. Read more here: [Comma Separated Vulnerabilities](https://www.contextis.com/blog/comma-separated-vulnerabilities). Due to this issue, if a field starts with characters `=`, `@`, `+`, or `-`, that field will be prepended with a `\\t`. If the field is quoted, the `\\t` will come after the `\"`.\r\n\r\n```\r\n=one   -> \\t=one\r\n\"=one\" -> \"\\t=one\"\r\n```\r\n\r\nYou are able to turn off this functionality in configuration.\r\n\r\n```cs\r\ncsv.Configuration.SanitizeForInjection = false;\r\n```\r\n\r\n## Writing All Records\r\n\r\n<hr/>\r\n\r\nThe most common scenario is using the `WriteRecords` method. You can pass it an `IEnumerable` of records and it will write those objects.\r\n\r\n### WriteRecords\r\n\r\nWrites all records.\r\n\r\n```cs\r\nvar records = new List<MyClass>\r\n{\r\n\tnew MyClass { Id = 1, Name = \"one\" },\r\n\tnew MyClass { Id = 2, Name = \"two\" },\r\n};\r\ncsv.WriteRecords( records );\r\n\r\n// Dynamic\r\nvar records = new List<dynamic>();\r\ndynamic record = new ExpandoObject();\r\nrecord.Id = 1;\r\nrecord.Name = \"one\";\r\nrecords.Add( record );\r\ncsv.WriteRecords( records );\r\n\r\n// Anonymous\r\nvar records = new List<object>\r\n{\r\n\tnew { Id = 1, Name = \"one\" },\r\n\tnew { Id = 2, Name = \"two\" },\r\n};\r\ncsv.WriteRecords( records );\r\n```\r\n\r\n## Writing a Single Record\r\n\r\n<hr/>\r\n\r\nSometimes you want to write individual records by themselves. When you are done writing the row, don't forget to call `NextRecord` to flush the data and write the line ending.\r\n\r\n### WriteHeader\r\n\r\nWrites the header record. You can call this method on any row if you want to write multiple headers.\r\n\r\n```cs\r\ncsv.WriteHeader<MyClass>();\r\ncsv.WriteHeader( Type type );\r\ncsv.NextRecord();\r\n```\r\n\r\n### WriteRecord\r\n\r\nWrites a record.\r\n\r\n```cs\r\nvar record = new MyClass { Id = 1, Name = \"one\" };\r\ncsv.WriteRecord( record );\r\ncsv.NextRecord();\r\n\r\n// Dynamic\r\ndynamic record = new ExpandoObject();\r\nrecord.Id = 1;\r\nrecord.Name = \"one\";\r\ncsv.WriteRecord( record );\r\ncsv.NextRecord();\r\n\r\n// Anonymous\r\nvar record = new { Id = 1, Name = \"one\" };\r\ncsv.WriteRecord( record );\r\ncsv.NextRecord();\r\n```\r\n\r\n## Writing Fields\r\n\r\n<hr/>\r\n\r\nYou can even write a single field.\r\n\r\n### WriteField\r\n\r\nWrite any type of object to a field. You can specify your own `ITypeConverter` to handle converting the type to a string if none of the built in converters work for you.\r\n\r\n```cs\r\n// Write a string\r\ncsv.WriteField( \"field\" );\r\n\r\n// Write a string passing in a value indicating\r\n// if the field should be quoted. This will ignore\r\n// any configuration and only quote based on the\r\n// shouldQuote parameter passed in.\r\ncsv.WriteField( \"field\", true );\r\n\r\n// Write any type\r\ncsv.WriteField( 1 );\r\n\r\n// Write any type and use the given type converter\r\n// to convert the type to a string.\r\ncsv.WriteField( value, myTypeConverter );\r\n\r\n// Write any type and use the given type converter\r\n// to convert the type to a string.\r\ncsv.WriteField<MyTypeConverter>( value );\r\n\r\n// Write a field that has already been converted\r\n// by a type converter. If the field is null, it\r\n// won't get written.\r\ncsv.WriteConvertedField( \"field\" );\r\n\r\n// Don't forget to forget to end the row.\r\ncsv.NextRecord();\r\n```\r\n\r\n### WriteComment\r\n\r\nThis will write text to the field using the comment character supplied in `Configuration.Comment`.\r\n\r\n```cs\r\ncsv.WriteComment( \"This is a comment. \");\r\ncsv.NextRecord();\r\n```\r\n\r\n## Ending the Row\r\n\r\n<hr/>\r\n\r\nWhen you are done writing the row, you need to flush the fields and start a new row. Flushing and starting a new row are separated so that you can flush without creating a new row. Calling `NextRecord` will flush for you.\r\n\r\n### Flush\r\n\r\nSerialize the fields to the `TextReader`.\r\n\r\n```cs\r\ncsv.Flush();\r\n```\r\n\r\n### FlushAsync\r\n\r\nSerialize the fields to the `TextReader` asynchronously. If the `TextReader` supplied is tied to a network or some other slow to write functionality, flushing asynchronously is probably a good idea.\r\n\r\n```cs\r\ncsv.FlushAsync();\r\n```\r\n\r\n### NextRecord\r\n\r\nEnds the current record and starts a new record. This will call `Flush` then write a newline.\r\n\r\n```cs\r\ncsv.NextRecord();\r\n```\r\n\r\n### NextRecordAsync\r\n\r\nEnds the current record and start a new record asynchronously. This will call `FlushAsync` then asynchronously write a newline.\r\n\r\n```cs\r\ncsv.NextRecordAsync();\r\n```\r\n\r\n## Writing Context\r\n\r\n<hr/>\r\n\r\nWhen writing, all the information in the system is held in a context object. If you need to get raw system information for some reason, it's available here. When an exception is throw, the context is included so you can inspect the current state of the writer.\r\n\r\n## Configuration\r\n\r\n<hr/>\r\n\r\nSee <a href=\"/CsvHelper/configuration\">configuration</a>\r\n\r\n<br/>\r\n"},"siteData":{}};</script><script defer="" type="text/javascript" src="https://joshclose.github.io/CsvHelper/bootstrap.18f2d515.js"></script><script defer="" type="text/javascript" src="https://joshclose.github.io/CsvHelper/templates/src/components/content.a5c1a482.js"></script><script defer="" type="text/javascript" src="https://joshclose.github.io/CsvHelper/main.3bbedefe.js"></script></body></html>