<!DOCTYPE html><html lang="en-US"><head><link rel="preload" as="script" href="https://joshclose.github.io/CsvHelper/bootstrap.66ade461.js"/><link rel="preload" as="script" href="https://joshclose.github.io/CsvHelper/templates/src/pages/documentation.299022a3.js"/><link rel="preload" as="script" href="https://joshclose.github.io/CsvHelper/main.e799cab1.js"/><link rel="preload" as="style" href="https://joshclose.github.io/CsvHelper/main.css"/><link rel="stylesheet" href="https://joshclose.github.io/CsvHelper/main.css"/><link rel="preload" as="style" href="https://joshclose.github.io/CsvHelper/styles.95346b5a.css"/><link rel="stylesheet" href="https://joshclose.github.io/CsvHelper/styles.95346b5a.css"/><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="apple-touch-icon" sizes="57x57" href="https://joshclose.github.io/CsvHelper/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="https://joshclose.github.io/CsvHelper/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="https://joshclose.github.io/CsvHelper/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="https://joshclose.github.io/CsvHelper/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="https://joshclose.github.io/CsvHelper/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="https://joshclose.github.io/CsvHelper/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="https://joshclose.github.io/CsvHelper/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="https://joshclose.github.io/CsvHelper/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="https://joshclose.github.io/CsvHelper/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="https://joshclose.github.io/CsvHelper/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="https://joshclose.github.io/CsvHelper/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="https://joshclose.github.io/CsvHelper/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="https://joshclose.github.io/CsvHelper/favicon-16x16.png"/><link rel="manifest" href="https://joshclose.github.io/CsvHelper/manifest.json"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"/><meta name="theme-color" content="#ffffff"/><title>CsvHelper</title></head><body><div id="root"><header class="header"><nav class="navbar is-light"><div class="container is-fluid"><div class="navbar-brand"><a class="navbar-item active" aria-current="page" href="https://joshclose.github.io/CsvHelper/"><img src="https://joshclose.github.io/CsvHelper/images/logo.svg" width="66" height="28"/></a><div class="navbar-burger burger"><span></span><span></span><span></span></div></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item active" aria-current="page" href="https://joshclose.github.io/CsvHelper/getting-started">Getting Started</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/examples">Examples</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/api">API</a><a class="navbar-item" href="https://joshclose.github.io/CsvHelper/change-log">Change Log</a></div><div class="navbar-end"><a class="navbar-item" href="https://twitter.com/JoshClose"><span class="icon"><svg aria-hidden="true" data-prefix="fab" data-icon="twitter" class="svg-inline--fa fa-twitter fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></span></a><a class="navbar-item" href="https://github.com/JoshClose/CsvHelper"><span class="icon"><svg aria-hidden="true" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></span></a></div></div></div></nav><div class="navbar"></div></header><div class="body"><div class="documentation container is-fluid"><div class="columns"><div class="column container-right"><div class="sidebar" style="bottom:0"><div class="toc"><div class="toc-item" style="padding-left:10px"><a class="toc-item-name" href="https://joshclose.github.io/CsvHelper/getting-started#installation">Installation</a></div><div class="toc-item" style="padding-left:10px"><a class="toc-item-name" href="https://joshclose.github.io/CsvHelper/getting-started#reading-a-csv-file">Reading a CSV File</a></div><div class="toc-item" style="padding-left:10px"><a class="toc-item-name" href="https://joshclose.github.io/CsvHelper/getting-started#writing-a-csv-file">Writing a CSV File</a></div></div></div></div><div class="column container-content"><div class="getting-started"><h1 id="getting-started" class="title is-1"><span>Getting Started</span></h1><h2 id="installation" class="title is-2"><span>Installation</span></h2><hr />

<h3 id="package-manager-console" class="title is-3"><span>Package Manager Console</span></h3><div class="columns"><div class="column" style="overflow-x: auto"><pre><code class="undefined">PM&gt; Install-Package CsvHelper</code></pre></div></div><h3 id="net-cli-console" class="title is-3"><span>.NET CLI Console</span></h3><div class="columns"><div class="column" style="overflow-x: auto"><pre><code class="undefined">&gt; dotnet <span class="hljs-keyword">add</span> package CsvHelper</code></pre></div></div><h2 id="reading-a-csv-file" class="title is-2"><span>Reading a CSV File</span></h2><hr />

<div class="columns"><div class="column"><p>Let&#39;s say we have CSV file that looks like this.</p></div></div><div class="columns"><div class="column" style="overflow-x: auto"><pre><code class="undefined">Id,Name
1,one
2,two</code></pre></div></div><div class="columns"><div class="column"><p>And a class definition that looks like this.</p></div></div><div class="columns"><div class="column" style="overflow-x: auto"><pre><code class="cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> Id { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> Name { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}</code></pre></div></div><div class="columns"><div class="column"><p>If our class property names match our CSV file header names, we can read the file without any configuration.</p></div></div><div class="columns"><div class="column" style="overflow-x: auto"><pre><code class="cs"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> reader = <span class="hljs-keyword">new</span> StreamReader(<span class="hljs-string">"path\\to\\file.csv"</span>))
<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> csv = <span class="hljs-keyword">new</span> CsvReader(reader))
{    
    <span class="hljs-keyword">var</span> records = csv.GetRecords&lt;Foo&gt;();
}</code></pre></div></div><div class="columns"><div class="column"><p>The <code>GetRecords&lt;T&gt;</code> method will return an <code>IEnumerable&lt;T&gt;</code> that will <code>yield</code> records.
What this means is that only a single record is returned at a time as you iterate the records.
That also means that only a small portion of the file is read into memory. Be careful though.
If you do anything that executes a LINQ projection, such as calling <code>.ToList()</code>, the entire file
will be read into memory. <code>CsvReader</code> is forward only, so if you want to run any LINQ queries
against your data, you&#39;ll have to pull the whole file into memory. Just know that is what you&#39;re doing.</p></div></div><div class="columns"><div class="column"><p>Let&#39;s say our CSV file names are a little different than our class properties and we don&#39;t want to
make our properties match. </p></div></div><div class="columns"><div class="column" style="overflow-x: auto"><pre><code class="undefined">id,name
1,one
2,two</code></pre></div></div><div class="columns"><div class="column"><p>In this case, the names are lower case. We want our property names to be Pascal Case, so we can
just change how our properties match against the header names.</p></div></div><div class="columns"><div class="column" style="overflow-x: auto"><pre><code class="cs"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> reader = <span class="hljs-keyword">new</span> StreamReader(<span class="hljs-string">"path\\to\\file.csv"</span>))
<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> csv = <span class="hljs-keyword">new</span> CsvReader(reader))
{    
    csv.Configuration.PrepareHeaderForMatch = (<span class="hljs-keyword">string</span> header, <span class="hljs-keyword">int</span> index) =&gt; header.ToLower();
    <span class="hljs-keyword">var</span> records = csv.GetRecords&lt;Foo&gt;();
}</code></pre></div></div><div class="columns"><div class="column"><p>Using the configuration <code>PrepareHeaderForMatch</code>, we&#39;re able to change how the header matching
is done against the property name. Both the header and the property name are ran through the
<code>PrepareHeaderForMatch</code> function. When the reader needs to find the property to set for the
header, they will now match. You can use this function to do other things such as remove
whitespace or other characters.</p></div></div><div class="columns"><div class="column"><p>Let&#39;s say out CSV file doesn&#39;t have a header at all.</p></div></div><div class="columns"><div class="column" style="overflow-x: auto"><pre><code class="undefined">1,one
2,two</code></pre></div></div><div class="columns"><div class="column"><p>First we need to tell the reader that there is no header record, using configuration.</p></div></div><div class="columns"><div class="column" style="overflow-x: auto"><pre><code class="cs"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> reader = <span class="hljs-keyword">new</span> StreamReader(<span class="hljs-string">"path\\to\\file.csv"</span>))
<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> csv = <span class="hljs-keyword">new</span> CsvReader(reader))
{    
    csv.Configuration.HasHeaderRecord = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> records = csv.GetRecords&lt;Foo&gt;();
}</code></pre></div></div><div class="columns"><div class="column"><p>CsvReader will use the position of the properties in the class as the index position. There is an
issue with this though. <a href="https://blogs.msdn.microsoft.com/haibo_luo/2006/07/10/member-order-returned-by-getfields-getmethods/" target="_self">You can&#39;t rely on the ordering of class members in .NET</a>.
We can solve this by mapping the property to a position in the CSV file.</p></div></div><div class="columns"><div class="column"><p>One way to do this is with attribute mapping.</p></div></div><div class="columns"><div class="column" style="overflow-x: auto"><pre><code class="cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span>
{
    [<span class="hljs-meta">Index(0)</span>]
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> Id { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

    [<span class="hljs-meta">Index(1)</span>]
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> Name { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}</code></pre></div></div><div class="columns"><div class="column"><p>The <code>IndexAttribute</code> allows you to specify which position the CSV field is that you want to use
for the property.</p></div></div><div class="columns"><div class="column"><p>You can also map by name. Let&#39;s use our lower case header example from before and see how we can
use attributes instead of changing the header matching.</p></div></div><div class="columns"><div class="column" style="overflow-x: auto"><pre><code class="cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span>
{
    [<span class="hljs-meta">Name(<span class="hljs-meta-string">"id"</span>)</span>]
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> Id { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

    [<span class="hljs-meta">Name(<span class="hljs-meta-string">"name"</span>)</span>]
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> Name { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}</code></pre></div></div><div class="columns"><div class="column"><p><a href="https://joshclose.github.io/CsvHelper/documentation/mapping/attributes" target="_self">There are many other attributes you can use also.</a></p></div></div><div class="columns"><div class="column"><p>What if we don&#39;t have control over the class we want to map to so we can&#39;t add attributes to it?
In this case, we can use a fluent <code>ClassMap</code> to do the mapping.</p></div></div><div class="columns"><div class="column" style="overflow-x: auto"><pre><code class="cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">FooMap</span> : <span class="hljs-title">ClassMap</span>&lt;<span class="hljs-title">Foo</span>&gt;
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">FooMap</span>(<span class="hljs-params"></span>)</span>
    {
        Map(m =&gt; m.Id).Name(<span class="hljs-string">"id"</span>);
        Map(m =&gt; m.Name).Name(<span class="hljs-string">"name"</span>);
    }
}</code></pre></div></div><div class="columns"><div class="column"><p>To use the mapping, we need to register it in the configuration.</p></div></div><div class="columns"><div class="column" style="overflow-x: auto"><pre><code class="cs"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> reader = <span class="hljs-keyword">new</span> StreamReader(<span class="hljs-string">"path\\to\\file.csv"</span>))
<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> csv = <span class="hljs-keyword">new</span> CsvReader(reader))
{    
    csv.Configuration.RegisterClassMap&lt;FooMap&gt;();
    <span class="hljs-keyword">var</span> records = csv.GetRecords&lt;Foo&gt;();
}</code></pre></div></div><div class="columns"><div class="column"><p>Creating a class map is the recommended way of mapping files in CsvHelper because it&#39;s a
lot more powerful.</p></div></div><h2 id="writing-a-csv-file" class="title is-2"><span>Writing a CSV File</span></h2><div class="columns"><div class="column"><p>Now let&#39;s look at how we can write CSV files. It&#39;s basically the same thing, but in reverse order.</p></div></div><div class="columns"><div class="column"><p>Let&#39;s use the same class definition as before.</p></div></div><div class="columns"><div class="column" style="overflow-x: auto"><pre><code class="cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> Id { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> Name { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}</code></pre></div></div><div class="columns"><div class="column"><p>And we have a set of records like this.</p></div></div><div class="columns"><div class="column" style="overflow-x: auto"><pre><code class="cs"><span class="hljs-keyword">var</span> records = <span class="hljs-keyword">new</span> List&lt;Foo&gt;
{
    <span class="hljs-keyword">new</span> Foo { Id = <span class="hljs-number">1</span>, Name = <span class="hljs-string">"one"</span> },
    <span class="hljs-keyword">new</span> Foo { Id = <span class="hljs-number">2</span>, Name = <span class="hljs-string">"two"</span> },
};</code></pre></div></div><div class="columns"><div class="column"><p>We can write the records to a file without any configuration.</p></div></div><div class="columns"><div class="column" style="overflow-x: auto"><pre><code class="cs"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> writer = <span class="hljs-keyword">new</span> StreamWriter(<span class="hljs-string">"path\\to\\file.csv"</span>))
<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> csv = <span class="hljs-keyword">new</span> CsvWriter(writer))
{    
    csv.WriteRecords(records);
}</code></pre></div></div><div class="columns"><div class="column"><p>The <code>WriteRecords</code> method will write all the records to the file. After you are done writing,
you should call <code>writer.Flush()</code> to ensure that all the data in the writer&#39;s internal buffer
has been flushed to the file. Once a <code>using</code> block has exited, the writer is automatically
flushed, so we don&#39;t have to explicitly do it here. It&#39;s recommended to always wrap any
<code>IDisposable</code> object with <code>using</code> blocks. The object will dispose of itself (and in our case
flush too) as soon as possible after the <code>using</code> block has exited.</p></div></div><div class="columns"><div class="column"><p>Remember how we can&#39;t rely on property order in .NET? If we are writing a class that has a header,
it doesn&#39;t matter, as long as we are reading using the headers later. If we want to position
the headers in the CSV file, we need to specify an index to guarantee it&#39;s order. It&#39;s
recommended to always set an index when writing.</p></div></div><div class="columns"><div class="column" style="overflow-x: auto"><pre><code class="cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">FooMap</span> : <span class="hljs-title">ClassMap</span>&lt;<span class="hljs-title">Foo</span>&gt;
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">FooMap</span>(<span class="hljs-params"></span>)</span>
    {
        Map(m =&gt; m.Id).Index(<span class="hljs-number">0</span>).Name(<span class="hljs-string">"id"</span>);
        Map(m =&gt; m.Name).Index(<span class="hljs-number">1</span>).Name(<span class="hljs-string">"name"</span>);
    }
}</code></pre></div></div><div class="columns"><div class="column"><p><br/></p></div></div></div><br/></div></div></div></div><footer class="footer"><div class="has-text-centered">© 2009-2019 Josh Close</div></footer></div><script type="text/javascript">window.__CSS_CHUNKS__ = {"main":"https://joshclose.github.io/CsvHelper/styles.95346b5a.css"}</script><script type="text/javascript">
    window.__routeInfo = {"path":"getting-started","templateID":1,"sharedPropsHashes":{},"localProps":null,"allProps":{"className":"getting-started","data":"# Getting Started\r\n\r\n## Installation\r\n<hr />\r\n\r\n### Package Manager Console\r\n\r\n```\r\nPM> Install-Package CsvHelper\r\n```\r\n\r\n### .NET CLI Console\r\n\r\n```\r\n> dotnet add package CsvHelper\r\n```\r\n\r\n## Reading a CSV File\r\n<hr />\r\n\r\nLet's say we have CSV file that looks like this.\r\n\r\n```\r\nId,Name\r\n1,one\r\n2,two\r\n```\r\n\r\nAnd a class definition that looks like this.\r\n\r\n```cs\r\npublic class Foo\r\n{\r\n\tpublic int Id { get; set; }\r\n\tpublic string Name { get; set; }\r\n}\r\n```\r\n\r\nIf our class property names match our CSV file header names, we can read the file without any configuration.\r\n\r\n```cs\r\nusing (var reader = new StreamReader(\"path\\\\to\\\\file.csv\"))\r\nusing (var csv = new CsvReader(reader))\r\n{\t\r\n\tvar records = csv.GetRecords<Foo>();\r\n}\r\n```\r\n\r\nThe `GetRecords<T>` method will return an `IEnumerable<T>` that will `yield` records.\r\nWhat this means is that only a single record is returned at a time as you iterate the records.\r\nThat also means that only a small portion of the file is read into memory. Be careful though.\r\nIf you do anything that executes a LINQ projection, such as calling `.ToList()`, the entire file\r\nwill be read into memory. `CsvReader` is forward only, so if you want to run any LINQ queries\r\nagainst your data, you'll have to pull the whole file into memory. Just know that is what you're doing.\r\n\r\nLet's say our CSV file names are a little different than our class properties and we don't want to\r\nmake our properties match. \r\n\r\n```\r\nid,name\r\n1,one\r\n2,two\r\n```\r\n\r\nIn this case, the names are lower case. We want our property names to be Pascal Case, so we can\r\njust change how our properties match against the header names.\r\n\r\n```cs\r\nusing (var reader = new StreamReader(\"path\\\\to\\\\file.csv\"))\r\nusing (var csv = new CsvReader(reader))\r\n{\t\r\n\tcsv.Configuration.PrepareHeaderForMatch = (string header, int index) => header.ToLower();\r\n\tvar records = csv.GetRecords<Foo>();\r\n}\r\n```\r\n\r\nUsing the configuration `PrepareHeaderForMatch`, we're able to change how the header matching\r\nis done against the property name. Both the header and the property name are ran through the\r\n`PrepareHeaderForMatch` function. When the reader needs to find the property to set for the\r\nheader, they will now match. You can use this function to do other things such as remove\r\nwhitespace or other characters.\r\n\r\nLet's say out CSV file doesn't have a header at all.\r\n\r\n```\r\n1,one\r\n2,two\r\n```\r\n\r\nFirst we need to tell the reader that there is no header record, using configuration.\r\n\r\n```cs\r\nusing (var reader = new StreamReader(\"path\\\\to\\\\file.csv\"))\r\nusing (var csv = new CsvReader(reader))\r\n{\t\r\n\tcsv.Configuration.HasHeaderRecord = false;\r\n\tvar records = csv.GetRecords<Foo>();\r\n}\r\n```\r\n\r\nCsvReader will use the position of the properties in the class as the index position. There is an\r\nissue with this though. [You can't rely on the ordering of class members in .NET](https://blogs.msdn.microsoft.com/haibo_luo/2006/07/10/member-order-returned-by-getfields-getmethods/).\r\nWe can solve this by mapping the property to a position in the CSV file.\r\n\r\nOne way to do this is with attribute mapping.\r\n\r\n```cs\r\npublic class Foo\r\n{\r\n\t[Index(0)]\r\n\tpublic int Id { get; set; }\r\n\r\n\t[Index(1)]\r\n\tpublic string Name { get; set; }\r\n}\r\n```\r\n\r\nThe `IndexAttribute` allows you to specify which position the CSV field is that you want to use\r\nfor the property.\r\n\r\nYou can also map by name. Let's use our lower case header example from before and see how we can\r\nuse attributes instead of changing the header matching.\r\n\r\n```cs\r\npublic class Foo\r\n{\r\n\t[Name(\"id\")]\r\n\tpublic int Id { get; set; }\r\n\r\n\t[Name(\"name\")]\r\n\tpublic string Name { get; set; }\r\n}\r\n```\r\n\r\n[There are many other attributes you can use also.](/documentation/mapping/attributes)\r\n\r\nWhat if we don't have control over the class we want to map to so we can't add attributes to it?\r\nIn this case, we can use a fluent `ClassMap` to do the mapping.\r\n\r\n```cs\r\npublic class FooMap : ClassMap<Foo>\r\n{\r\n\tpublic FooMap()\r\n\t{\r\n\t\tMap(m => m.Id).Name(\"id\");\r\n\t\tMap(m => m.Name).Name(\"name\");\r\n\t}\r\n}\r\n```\r\n\r\nTo use the mapping, we need to register it in the configuration.\r\n\r\n```cs\r\nusing (var reader = new StreamReader(\"path\\\\to\\\\file.csv\"))\r\nusing (var csv = new CsvReader(reader))\r\n{\t\r\n\tcsv.Configuration.RegisterClassMap<FooMap>();\r\n\tvar records = csv.GetRecords<Foo>();\r\n}\r\n```\r\n\r\nCreating a class map is the recommended way of mapping files in CsvHelper because it's a\r\nlot more powerful.\r\n\r\n## Writing a CSV File\r\n\r\nNow let's look at how we can write CSV files. It's basically the same thing, but in reverse order.\r\n\r\nLet's use the same class definition as before.\r\n\r\n```cs\r\npublic class Foo\r\n{\r\n\tpublic int Id { get; set; }\r\n\tpublic string Name { get; set; }\r\n}\r\n```\r\n\r\nAnd we have a set of records like this.\r\n\r\n```cs\r\nvar records = new List<Foo>\r\n{\r\n\tnew Foo { Id = 1, Name = \"one\" },\r\n\tnew Foo { Id = 2, Name = \"two\" },\r\n};\r\n```\r\n\r\nWe can write the records to a file without any configuration.\r\n\r\n```cs\r\nusing (var writer = new StreamWriter(\"path\\\\to\\\\file.csv\"))\r\nusing (var csv = new CsvWriter(writer))\r\n{\t\r\n\tcsv.WriteRecords(records);\r\n}\r\n```\r\n\r\nThe `WriteRecords` method will write all the records to the file. After you are done writing,\r\nyou should call `writer.Flush()` to ensure that all the data in the writer's internal buffer\r\nhas been flushed to the file. Once a `using` block has exited, the writer is automatically\r\nflushed, so we don't have to explicitly do it here. It's recommended to always wrap any\r\n`IDisposable` object with `using` blocks. The object will dispose of itself (and in our case\r\nflush too) as soon as possible after the `using` block has exited.\r\n\r\nRemember how we can't rely on property order in .NET? If we are writing a class that has a header,\r\nit doesn't matter, as long as we are reading using the headers later. If we want to position\r\nthe headers in the CSV file, we need to specify an index to guarantee it's order. It's\r\nrecommended to always set an index when writing.\r\n\r\n```cs\r\npublic class FooMap : ClassMap<Foo>\r\n{\r\n\tpublic FooMap()\r\n\t{\r\n\t\tMap(m => m.Id).Index(0).Name(\"id\");\r\n\t\tMap(m => m.Name).Index(1).Name(\"name\");\r\n\t}\r\n}\r\n```\r\n\r\n<br/>","toc":{"title":"Getting Started","path":"getting-started","children":[{"title":"Installation","path":"getting-started#installation"},{"title":"Reading a CSV File","path":"getting-started#reading-a-csv-file"},{"title":"Writing a CSV File","path":"getting-started#writing-a-csv-file"}]}},"siteData":{"isDev":false}};</script><script defer="" type="text/javascript" src="https://joshclose.github.io/CsvHelper/bootstrap.66ade461.js"></script><script defer="" type="text/javascript" src="https://joshclose.github.io/CsvHelper/templates/src/pages/documentation.299022a3.js"></script><script defer="" type="text/javascript" src="https://joshclose.github.io/CsvHelper/main.e799cab1.js"></script></body></html>